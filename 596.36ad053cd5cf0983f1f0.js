"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[596],{596:function(e,a,n){n.r(a),n(7378);var t=n(2682);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function p({components:e,...a}){return(0,t.kt)("wrapper",s({components:e},a),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,t.kt)("p",{parentName:"aside"},"This guide extends the example provided in ",(0,t.kt)("a",{href:"/guides/getting-started",parentName:"p"},"Getting Started"),". Please make sure you are at least familiar with the example provided there and the ",(0,t.kt)("a",{href:"/guides/output-management/",parentName:"p"},"Output Management")," chapter.")),(0,t.kt)("p",null,"Code splitting is one of the most compelling features of webpack. This feature allows you to split your code into various bundles which can then be loaded on demand or in parallel. It can be used to achieve smaller bundles and control resource load prioritization which, if used correctly, can have a major impact on load time."),(0,t.kt)("p",null,"There are three general approaches to code splitting available:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("strong",{parentName:"li"},"Entry Points"),": Manually split code using ",(0,t.kt)("a",{href:"/configuration/entry-context",parentName:"li"},(0,t.kt)("inlineCode",{parentName:"a"},"entry"))," configuration."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("strong",{parentName:"li"},"Prevent Duplication"),": Use ",(0,t.kt)("a",{href:"/configuration/entry-context/#dependencies",parentName:"li"},"Entry dependencies")," or ",(0,t.kt)("a",{href:"/plugins/split-chunks-plugin/",parentName:"li"},(0,t.kt)("inlineCode",{parentName:"a"},"SplitChunksPlugin"))," to dedupe and split chunks."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("strong",{parentName:"li"},"Dynamic Imports"),": Split code via inline function calls within modules.")),(0,t.kt)("h2",{id:"entry-points"},"Entry Points",(0,t.kt)("a",{href:"#entry-points","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"This is by far the easiest and most intuitive way to split code. However, it is more manual and has some pitfalls we will go over. Let's take a look at how we might split another module from the main bundle:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"project")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},"webpack-demo\n|- package.json\n|- webpack.config.js\n|- /dist\n|- /src\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," |- index.js\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"}," |- another-module.js\n")),"|- /node_modules")),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"another-module.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import")," _ ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'lodash'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nconsole",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"log"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"_",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"join"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'Another'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'module'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'loaded!'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"' '"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"module.exports = {\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  entry: './src/index.js',\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  mode: 'development',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  entry: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    index: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    another: './src/another-module.js',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  output: {\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    filename: 'main.js',\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    filename: '[name].bundle.js',\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"};")))),(0,t.kt)("p",null,"This will yield the following build result:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},".."),".\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"webpack-cli",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," Compilation finished\nasset index.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"553")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"emitted",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: index",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset another.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"553")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"emitted",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: another",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nruntime modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"2.49")," KiB ",(0,t.kt)("span",{className:"token number",parentName:"code"},"12")," modules\ncacheable modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB\n  ./src/index.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"257")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./src/another-module.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"84")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./node_modules/lodash/lodash.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\nwebpack ",(0,t.kt)("span",{className:"token number",parentName:"code"},"5.4"),".0 compiled successfully ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"in")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"245")," ms")),(0,t.kt)("p",null,"As mentioned there are some pitfalls to this approach:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"If there are any duplicated modules between entry chunks they will be included in both bundles."),(0,t.kt)("li",{parentName:"ul"},"It isn't as flexible and can't be used to dynamically split code with the core application logic.")),(0,t.kt)("p",null,"The first of these two points is definitely an issue for our example, as ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," is also imported within ",(0,t.kt)("inlineCode",{parentName:"p"},"./src/index.js")," and will thus be duplicated in both bundles. Let's remove this duplication in next section."),(0,t.kt)("h2",{id:"prevent-duplication"},"Prevent Duplication",(0,t.kt)("a",{href:"#prevent-duplication","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("h3",{id:"entry-dependencies"},"Entry dependencies",(0,t.kt)("a",{href:"#entry-dependencies","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"The ",(0,t.kt)("a",{href:"/configuration/entry-context/#dependencies",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"dependOn")," option")," allows to share the modules between the chunks:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  mode: 'development',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  entry: {\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    index: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    another: './src/another-module.js',\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    index: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      import: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      dependOn: 'shared',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    },\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    another: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      import: './src/another-module.js',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      dependOn: 'shared',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    },\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    shared: 'lodash',\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    filename: '[name].bundle.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"};")))),(0,t.kt)("p",null,"If we're going to use multiple entry points on a single HTML page, ",(0,t.kt)("inlineCode",{parentName:"p"},"optimization.runtimeChunk: 'single'")," is needed too, otherwise we could get into trouble described ",(0,t.kt)("a",{href:"https://bundlers.tooling.report/code-splitting/multi-entry/",parentName:"p"},"here"),"."),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  mode: 'development',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  entry: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    index: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"      import: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"      dependOn: 'shared',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    another: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"      import: './src/another-module.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"      dependOn: 'shared',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    shared: 'lodash',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    filename: '[name].bundle.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  optimization: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    runtimeChunk: 'single',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"};")))),(0,t.kt)("p",null,"And here's the result of build:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},".."),".\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"webpack-cli",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," Compilation finished\nasset shared.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"549")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: shared",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset runtime.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"7.79")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: runtime",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset index.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1.77")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: index",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset another.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1.65")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: another",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nEntrypoint index ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1.77")," KiB ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," index.bundle.js\nEntrypoint another ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1.65")," KiB ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," another.bundle.js\nEntrypoint shared ",(0,t.kt)("span",{className:"token number",parentName:"code"},"557")," KiB ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," runtime.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"7.79")," KiB shared.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"549")," KiB\nruntime modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"3.76")," KiB ",(0,t.kt)("span",{className:"token number",parentName:"code"},"7")," modules\ncacheable modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB\n  ./node_modules/lodash/lodash.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./src/another-module.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"84")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./src/index.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"257")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\nwebpack ",(0,t.kt)("span",{className:"token number",parentName:"code"},"5.4"),".0 compiled successfully ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"in")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"249")," ms")),(0,t.kt)("p",null,"As you can see there's another ",(0,t.kt)("inlineCode",{parentName:"p"},"runtime.bundle.js")," file generated besides ",(0,t.kt)("inlineCode",{parentName:"p"},"shared.bundle.js"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"index.bundle.js")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"another.bundle.js"),"."),(0,t.kt)("p",null,"Although using multiple entry points per page is allowed in webpack, it should be avoided when possible in favor of an entry point with multiple imports: ",(0,t.kt)("inlineCode",{parentName:"p"},"entry: { page: ['./analytics', './app'] }"),". This results in a better optimization and consistent execution order when using ",(0,t.kt)("inlineCode",{parentName:"p"},"async")," script tags."),(0,t.kt)("h3",{id:"splitchunksplugin"},"SplitChunksPlugin",(0,t.kt)("a",{href:"#splitchunksplugin","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"The ",(0,t.kt)("a",{href:"/plugins/split-chunks-plugin/",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"SplitChunksPlugin"))," allows us to extract common dependencies into an existing entry chunk or an entirely new chunk. Let's use this to de-duplicate the ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," dependency from the previous example:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   mode: 'development',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   entry: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     index: './src/index.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     another: './src/another-module.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     filename: '[name].bundle.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"     path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"   },\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"   optimization: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"     splitChunks: {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"       chunks: 'all',\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"     },\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"   },\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," };")))),(0,t.kt)("p",null,"With the ",(0,t.kt)("a",{href:"/plugins/split-chunks-plugin/#optimizationsplitchunks",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"optimization.splitChunks"))," configuration option in place, we should now see the duplicate dependency removed from our ",(0,t.kt)("inlineCode",{parentName:"p"},"index.bundle.js")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"another.bundle.js"),". The plugin should notice that we've separated ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," out to a separate chunk and remove the dead weight from our main bundle. Let's do an ",(0,t.kt)("inlineCode",{parentName:"p"},"npm run build")," to see if it worked:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},".."),".\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"webpack-cli",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," Compilation finished\nasset vendors-node_modules_lodash_lodash_js.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"549")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"id hint: vendors",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset index.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"8.92")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: index",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset another.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"8.8")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: another",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nEntrypoint index ",(0,t.kt)("span",{className:"token number",parentName:"code"},"558")," KiB ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," vendors-node_modules_lodash_lodash_js.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"549")," KiB index.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"8.92")," KiB\nEntrypoint another ",(0,t.kt)("span",{className:"token number",parentName:"code"},"558")," KiB ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," vendors-node_modules_lodash_lodash_js.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"549")," KiB another.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"8.8")," KiB\nruntime modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"7.64")," KiB ",(0,t.kt)("span",{className:"token number",parentName:"code"},"14")," modules\ncacheable modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB\n  ./src/index.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"257")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./src/another-module.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"84")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./node_modules/lodash/lodash.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\nwebpack ",(0,t.kt)("span",{className:"token number",parentName:"code"},"5.4"),".0 compiled successfully ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"in")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"241")," ms")),(0,t.kt)("p",null,"Here are some other useful plugins and loaders provided by the community for splitting code:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"/plugins/mini-css-extract-plugin",parentName:"li"},(0,t.kt)("inlineCode",{parentName:"a"},"mini-css-extract-plugin")),": Useful for splitting CSS out from the main application.")),(0,t.kt)("h2",{id:"dynamic-imports"},"Dynamic Imports",(0,t.kt)("a",{href:"#dynamic-imports","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Two similar techniques are supported by webpack when it comes to dynamic code splitting. The first and recommended approach is to use the ",(0,t.kt)("a",{href:"/api/module-methods/#import-1",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"import()")," syntax")," that conforms to the ",(0,t.kt)("a",{href:"https://github.com/tc39/proposal-dynamic-import",parentName:"p"},"ECMAScript proposal")," for dynamic imports. The legacy, webpack-specific approach is to use ",(0,t.kt)("a",{href:"/api/module-methods/#requireensure",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"require.ensure")),". Let's try using the first of these two approaches..."),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"warning"),(0,t.kt)("p",{parentName:"aside"},(0,t.kt)("inlineCode",{parentName:"p"},"import()")," calls use ",(0,t.kt)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",parentName:"p"},"promises")," internally. If you use ",(0,t.kt)("inlineCode",{parentName:"p"},"import()")," with older browsers (e.g., IE 11), remember to shim ",(0,t.kt)("inlineCode",{parentName:"p"},"Promise")," using a polyfill such as ",(0,t.kt)("a",{href:"https://github.com/stefanpenner/es6-promise",parentName:"p"},"es6-promise")," or ",(0,t.kt)("a",{href:"https://github.com/taylorhakes/promise-polyfill",parentName:"p"},"promise-polyfill"),".")),(0,t.kt)("p",null,"Before we start, let's remove the extra ",(0,t.kt)("a",{href:"/concepts/entry-points/",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"entry"))," and ",(0,t.kt)("a",{href:"/plugins/split-chunks-plugin",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"optimization.splitChunks"))," from our configuration in the above example as they won't be needed for this next demonstration:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"const path = require('path');\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"module.exports = {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  mode: 'development',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  entry: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    index: './src/index.js',\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    another: './src/another-module.js',\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  output: {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    filename: '[name].bundle.js',\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"    path: path.resolve(__dirname, 'dist'),\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  optimization: {\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    splitChunks: {\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      chunks: 'all',\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    },\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  },\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"};")))),(0,t.kt)("p",null,"We'll also update our project to remove the now unused files:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"project")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},"webpack-demo\n|- package.json\n|- webpack.config.js\n|- /dist\n|- /src\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"}," |- index.js\n")),(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"}," |- another-module.js\n")),"|- /node_modules")),(0,t.kt)("p",null,"Now, instead of statically importing ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash"),", we'll use dynamic importing to separate a chunk:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"src/index.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"import _ from 'lodash';\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"function component() {\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"function getComponent() {\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  const element = document.createElement('div');\n")),"\n",(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  // Lodash, now imported by this script\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  element.innerHTML = _.join(['Hello', 'webpack'], ' ');\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  return import('lodash')\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    .then(({ default: _ }) => {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      const element = document.createElement('div');\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      element.innerHTML = _.join(['Hello', 'webpack'], ' ');\n")),"\n",(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  return element;\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      return element;\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    })\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    .catch((error) => 'An error occurred while loading the component');\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"}\n")),"\n",(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"document.body.appendChild(component());\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"getComponent().then((component) => {\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  document.body.appendChild(component);\n"),(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"});")))),(0,t.kt)("p",null,"The reason we need ",(0,t.kt)("inlineCode",{parentName:"p"},"default")," is that since webpack 4, when importing a CommonJS module, the import will no longer resolve to the value of ",(0,t.kt)("inlineCode",{parentName:"p"},"module.exports"),", it will instead create an artificial namespace object for the CommonJS module. For more information on the reason behind this, read ",(0,t.kt)("a",{href:"https://medium.com/webpack/webpack-4-import-and-commonjs-d619d626b655",parentName:"p"},"webpack 4: import() and CommonJs"),"."),(0,t.kt)("p",null,"Let's run webpack to see ",(0,t.kt)("inlineCode",{parentName:"p"},"lodash")," separated out to a separate bundle:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},".."),".\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"webpack-cli",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," Compilation finished\nasset vendors-node_modules_lodash_lodash_js.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"549")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"id hint: vendors",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nasset index.bundle.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"13.5")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"compared ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"for")," emit",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"name: index",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\nruntime modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"7.37")," KiB ",(0,t.kt)("span",{className:"token number",parentName:"code"},"11")," modules\ncacheable modules ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB\n  ./src/index.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"434")," bytes ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\n  ./node_modules/lodash/lodash.js ",(0,t.kt)("span",{className:"token number",parentName:"code"},"530")," KiB ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"built",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"code generated",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),"\nwebpack ",(0,t.kt)("span",{className:"token number",parentName:"code"},"5.4"),".0 compiled successfully ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"in")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"268")," ms")),(0,t.kt)("p",null,"As ",(0,t.kt)("inlineCode",{parentName:"p"},"import()")," returns a promise, it can be used with ",(0,t.kt)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"async")," functions"),". Here's how it would simplify the code:"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"src/index.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-diff",parentName:"pre"},(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"function getComponent() {\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"async function getComponent() {\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  const element = document.createElement('div');\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  const { default: _ } = await import('lodash');\n")),"\n",(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  return import('lodash')\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    .then(({ default: _ }) => {\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      const element = document.createElement('div');\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  element.innerHTML = _.join(['Hello', 'webpack'], ' ');\n")),"\n",(0,t.kt)("span",{className:"token deleted-sign deleted",parentName:"code"},(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      element.innerHTML = _.join(['Hello', 'webpack'], ' ');\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"      return element;\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    })\n"),(0,t.kt)("span",{className:"token prefix deleted",parentName:"span"},"-"),(0,t.kt)("span",{className:"token line",parentName:"span"},"    .catch((error) => 'An error occurred while loading the component');\n")),(0,t.kt)("span",{className:"token inserted-sign inserted",parentName:"code"},(0,t.kt)("span",{className:"token prefix inserted",parentName:"span"},"+"),(0,t.kt)("span",{className:"token line",parentName:"span"},"  return element;\n")),(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"}\n")),"\n",(0,t.kt)("span",{className:"token unchanged",parentName:"code"},(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"getComponent().then((component) => {\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"  document.body.appendChild(component);\n"),(0,t.kt)("span",{className:"token prefix unchanged",parentName:"span"}," "),(0,t.kt)("span",{className:"token line",parentName:"span"},"});")))),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,t.kt)("p",{parentName:"aside"},"It is possible to provide a ",(0,t.kt)("a",{href:"/api/module-methods/#dynamic-expressions-in-import",parentName:"p"},"dynamic expression")," to ",(0,t.kt)("inlineCode",{parentName:"p"},"import()")," when you might need to import specific module based on a computed variable later.")),(0,t.kt)("h2",{id:"prefetchingpreloading-modules"},"Prefetching/Preloading modules",(0,t.kt)("a",{href:"#prefetchingpreloading-modules","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Webpack 4.6.0+ adds support for prefetching and preloading."),(0,t.kt)("p",null,"Using these inline directives while declaring your imports allows webpack to output “Resource Hint” which tells the browser that for:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("strong",{parentName:"li"},"prefetch"),": resource is probably needed for some navigation in the future"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("strong",{parentName:"li"},"preload"),": resource will also be needed during the current navigation")),(0,t.kt)("p",null,"An example of this is having a ",(0,t.kt)("inlineCode",{parentName:"p"},"HomePage")," component, which renders a ",(0,t.kt)("inlineCode",{parentName:"p"},"LoginButton")," component which then on demand loads a ",(0,t.kt)("inlineCode",{parentName:"p"},"LoginModal")," component after being clicked."),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"LoginButton.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token comment",parentName:"code"},"/* webpackPrefetch: true */")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./path/to/LoginModal.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"This will result in ",(0,t.kt)("inlineCode",{parentName:"p"},'<link rel="prefetch" href="login-modal-chunk.js">')," being appended in the head of the page, which will instruct the browser to prefetch in idle time the ",(0,t.kt)("inlineCode",{parentName:"p"},"login-modal-chunk.js")," file."),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,t.kt)("p",{parentName:"aside"},"webpack will add the prefetch hint once the parent chunk has been loaded.")),(0,t.kt)("p",null,"Preload directive has a bunch of differences compared to prefetch:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"A preloaded chunk starts loading in parallel to the parent chunk. A prefetched chunk starts after the parent chunk finishes loading."),(0,t.kt)("li",{parentName:"ul"},"A preloaded chunk has medium priority and is instantly downloaded. A prefetched chunk is downloaded while the browser is idle."),(0,t.kt)("li",{parentName:"ul"},"A preloaded chunk should be instantly requested by the parent chunk. A prefetched chunk can be used anytime in the future."),(0,t.kt)("li",{parentName:"ul"},"Browser support is different.")),(0,t.kt)("p",null,"An example of this can be having a ",(0,t.kt)("inlineCode",{parentName:"p"},"Component")," which always depends on a big library that should be in a separate chunk."),(0,t.kt)("p",null,"Let's imagine a component ",(0,t.kt)("inlineCode",{parentName:"p"},"ChartComponent")," which needs a huge ",(0,t.kt)("inlineCode",{parentName:"p"},"ChartingLibrary"),". It displays a ",(0,t.kt)("inlineCode",{parentName:"p"},"LoadingIndicator")," when rendered and instantly does an on demand import of ",(0,t.kt)("inlineCode",{parentName:"p"},"ChartingLibrary"),":"),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"ChartComponent.js")),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,t.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"import"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token comment",parentName:"code"},"/* webpackPreload: true */")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'ChartingLibrary'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"When a page which uses the ",(0,t.kt)("inlineCode",{parentName:"p"},"ChartComponent")," is requested, the charting-library-chunk is also requested via ",(0,t.kt)("inlineCode",{parentName:"p"},'<link rel="preload">'),". Assuming the page-chunk is smaller and finishes faster, the page will be displayed with a ",(0,t.kt)("inlineCode",{parentName:"p"},"LoadingIndicator"),", until the already requested ",(0,t.kt)("inlineCode",{parentName:"p"},"charting-library-chunk")," finishes. This will give a little load time boost since it only needs one round-trip instead of two. Especially in high-latency environments."),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,t.kt)("p",{parentName:"aside"},"Using ",(0,t.kt)("inlineCode",{parentName:"p"},"webpackPreload")," incorrectly can actually hurt performance, so be careful when using it.")),(0,t.kt)("h2",{id:"bundle-analysis"},"Bundle Analysis",(0,t.kt)("a",{href:"#bundle-analysis","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Once you start splitting your code, it can be useful to analyze the output to check where modules have ended up. The ",(0,t.kt)("a",{href:"https://github.com/webpack/analyse",parentName:"p"},"official analyze tool")," is a good place to start. There are some other community-supported options out there as well:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://alexkuz.github.io/webpack-chart/",parentName:"li"},"webpack-chart"),": Interactive pie chart for webpack stats."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://chrisbateman.github.io/webpack-visualizer/",parentName:"li"},"webpack-visualizer"),": Visualize and analyze your bundles to see which modules are taking up space and which might be duplicates."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://github.com/webpack-contrib/webpack-bundle-analyzer",parentName:"li"},"webpack-bundle-analyzer"),": A plugin and CLI utility that represents bundle content as a convenient interactive zoomable treemap."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://webpack.jakoblind.no/optimize",parentName:"li"},"webpack bundle optimize helper"),": This tool will analyze your bundle and give you actionable suggestions on what to improve to reduce your bundle size."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://github.com/bundle-stats/bundle-stats",parentName:"li"},"bundle-stats"),": Generate a bundle report(bundle size, assets, modules) and compare the results between different builds.")),(0,t.kt)("h2",{id:"next-steps"},"Next Steps",(0,t.kt)("a",{href:"#next-steps","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"See ",(0,t.kt)("a",{href:"/guides/lazy-loading/",parentName:"p"},"Lazy Loading")," for a more concrete example of how ",(0,t.kt)("inlineCode",{parentName:"p"},"import()")," can be used in a real application and ",(0,t.kt)("a",{href:"/guides/caching/",parentName:"p"},"Caching")," to learn how to split code more effectively."))}p.isMDXComponent=!0,a.default=p}}]);