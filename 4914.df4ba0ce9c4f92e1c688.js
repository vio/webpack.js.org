"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[4914],{4914:function(e,a,n){n.r(a),n(7378);var t=n(2682);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function o({components:e,...a}){return(0,t.kt)("wrapper",s({components:e},a),(0,t.kt)("p",null,"The ",(0,t.kt)("inlineCode",{parentName:"p"},"CommonsChunkPlugin")," is an opt-in feature that creates a separate file (known as a chunk), consisting of common modules shared between multiple entry points."),(0,t.kt)("aside",{className:"warning"},(0,t.kt)("h6",{className:"warning__prefix",parentName:"aside"},"warning"),(0,t.kt)("p",{parentName:"aside"},"The CommonsChunkPlugin has been removed in webpack v4 legato. To learn how chunks are treated in the latest version, check out the ",(0,t.kt)("a",{href:"/plugins/split-chunks-plugin/",parentName:"p"},"SplitChunksPlugin"),".")),(0,t.kt)("p",null,"By separating common modules from bundles, the resulting chunked file can be loaded once initially, and stored in cache for later use. This results in page speed optimizations as the browser can quickly serve the shared code from cache, rather than being forced to load a larger bundle whenever a new page is visited."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"options",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",{id:"options"},"Options",(0,t.kt)("a",{href:"#options","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-ts",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"string"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// or"),"\n  names",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"string"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// The chunk name of the commons chunk. An existing chunk can be selected by passing a name of an existing chunk."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If an array of strings is passed this is equal to invoking the plugin multiple times for each chunk name."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If omitted and `options.async` or `options.children` is set all chunks are used, otherwise `options.filename`"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// is used as chunk name."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// When using `options.async` to create common chunks from other async chunks you must specify an entry-point"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// chunk name here instead of omitting the `option.name`."),"\n\n  filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"string"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// The filename template for the commons chunk. Can contain the same placeholders as `output.filename`."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If omitted the original filename is not modified (usually `output.filename` or `output.chunkFilename`)."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// This option is not permitted if you're using `options.async` as well, see below for more details."),"\n\n  minChunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"number"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"|"),(0,t.kt)("span",{className:"token number",parentName:"code"},"Infinity"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"|"),(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token keyword",parentName:"code"},"module"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," count",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"boolean"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// The minimum number of chunks which need to contain a module before it's moved into the commons chunk."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// The number must be greater than or equal 2 and lower than or equal to the number of chunks."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// Passing `Infinity` creates the commons chunk, but moves no modules into it."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// By providing a `function` you can add custom logic. (Defaults to the number of chunks)"),"\n\n  chunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"string"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// Select the source chunks by chunk names. The chunk must be a child of the commons chunk."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If omitted all entry chunks are selected."),"\n\n  children",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"boolean"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If `true` all children of the commons chunk are selected"),"\n\n  deepChildren",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"boolean"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If `true` all descendants of the commons chunk are selected"),"\n\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"async"),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"boolean"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"|"),(0,t.kt)("span",{className:"token builtin",parentName:"code"},"string"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// If `true` a new async commons chunk is created as child of `options.name` and sibling of `options.chunks`."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// It is loaded in parallel with `options.chunks`."),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// Instead of using `option.filename`, it is possible to change the name of the output file by providing"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// the desired string here instead of `true`."),"\n\n  minSize",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token builtin",parentName:"code"},"number"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// Minimum size of all common module before a commons chunk is created."),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("h2",{id:"examples"},"Examples",(0,t.kt)("a",{href:"#examples","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("h3",{id:"commons-chunk-for-entries"},"Commons chunk for entries",(0,t.kt)("a",{href:"#commons-chunk-for-entries","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Generate an extra chunk, which contains common modules shared between entry points."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'commons'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (the commons chunk name)"),"\n\n  filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'commons.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (the filename of the commons chunk)"),"\n\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// minChunks: 3,"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (Modules must be shared between 3 entries)"),"\n\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// chunks: ["pageA", "pageB"],'),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (Only use these entries)"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"You must load the generated chunk before the entry point:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-html",parentName:"pre"},(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"commons.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'))," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"charset"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"utf-8",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"entry.bundle.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'))," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"charset"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"utf-8",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")))),(0,t.kt)("h3",{id:"explicit-vendor-chunk"},"Explicit vendor chunk",(0,t.kt)("a",{href:"#explicit-vendor-chunk","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Split your code into vendor and application."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n  entry",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    vendor",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'jquery'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'other-lib'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    app",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./entry'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  plugins",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'vendor'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// filename: "vendor.js"'),"\n      ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (Give the chunk a different name)"),"\n\n      minChunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"Infinity"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (with more entries, this ensures that no other module"),"\n      ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"//  goes into the vendor chunk)"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-html",parentName:"pre"},(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"vendor.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'))," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"charset"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"utf-8",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"app.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'))," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"charset"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"utf-8",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")))),(0,t.kt)("aside",{className:"tip"},(0,t.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,t.kt)("p",{parentName:"aside"},"In combination with long term caching you may need to use the ",(0,t.kt)("a",{href:"https://github.com/soundcloud/chunk-manifest-webpack-plugin",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"ChunkManifestWebpackPlugin"))," to avoid the vendor chunk changes. You should also use records to ensure stable module ids, e.g. using ",(0,t.kt)("inlineCode",{parentName:"p"},"NamedModulesPlugin")," or ",(0,t.kt)("a",{href:"/plugins/hashed-module-ids-plugin",parentName:"p"},(0,t.kt)("inlineCode",{parentName:"a"},"HashedModuleIdsPlugin")),".")),(0,t.kt)("h3",{id:"move-common-modules-into-the-parent-chunk"},"Move common modules into the parent chunk",(0,t.kt)("a",{href:"#move-common-modules-into-the-parent-chunk","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"With ",(0,t.kt)("a",{href:"/guides/code-splitting",parentName:"p"},"Code Splitting"),", multiple child chunks of an entry chunk can have common dependencies. To prevent duplication these can be moved into the parent. This reduces overall size, but does have a negative effect on the initial load time. If it is expected that users will need to download many sibling chunks, i.e. children of the entry chunk, then this should improve load time overall."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// names: ["app", "subPageA"]'),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (choose the chunks, or omit for all chunks)"),"\n\n  children",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (select all children of chosen chunks)"),"\n\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// minChunks: 3,"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (3 children must share the module before it's moved)"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h3",{id:"extra-async-commons-chunk"},"Extra async commons chunk",(0,t.kt)("a",{href:"#extra-async-commons-chunk","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Similar to the above one, but instead of moving common modules into the parent (which increases initial load time) a new async-loaded additional commons chunk is used. This is automatically downloaded in parallel when the additional chunk is downloaded."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'app'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// or"),"\n  names",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,t.kt)("span",{className:"token string",parentName:"code"},"'app'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'subPageA'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// the name or list of names must match the name or names"),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// of the entry points that create the async chunks"),"\n\n  children",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (use all children of the chunk)"),"\n\n  async",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (create an async commons chunk)"),"\n\n  minChunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"3"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// (3 children must share the module before it's separated)"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h3",{id:"passing-the-minchunks-property-a-function"},"Passing the ",(0,t.kt)("inlineCode",{parentName:"h3"},"minChunks")," property a function",(0,t.kt)("a",{href:"#passing-the-minchunks-property-a-function","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"You also have the ability to pass the ",(0,t.kt)("inlineCode",{parentName:"p"},"minChunks")," property a function. This function is called by the ",(0,t.kt)("inlineCode",{parentName:"p"},"CommonsChunkPlugin")," and calls the function with ",(0,t.kt)("inlineCode",{parentName:"p"},"module")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"count")," arguments."),(0,t.kt)("p",null,"The ",(0,t.kt)("inlineCode",{parentName:"p"},"module")," argument represents each module in the chunks you have provided via the ",(0,t.kt)("inlineCode",{parentName:"p"},"name"),"/",(0,t.kt)("inlineCode",{parentName:"p"},"names")," property.\n",(0,t.kt)("inlineCode",{parentName:"p"},"module")," has the shape of a ",(0,t.kt)("a",{href:"https://github.com/webpack/webpack/blob/master/lib/NormalModule.js",parentName:"p"},"NormalModule"),", which has two particularly useful properties for this use case:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"module.context"),": The directory that stores the file. For example: ",(0,t.kt)("inlineCode",{parentName:"li"},"'/my_project/node_modules/example-dependency'")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"module.resource"),": The name of the file being processed. For example: ",(0,t.kt)("inlineCode",{parentName:"li"},"'/my_project/node_modules/example-dependency/index.js'"))),(0,t.kt)("p",null,"The ",(0,t.kt)("inlineCode",{parentName:"p"},"count")," argument represents how many chunks the ",(0,t.kt)("inlineCode",{parentName:"p"},"module")," is used in."),(0,t.kt)("p",null,"This option is useful when you want to have fine-grained control over how the CommonsChunk algorithm determines where modules should be moved to."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'my-single-lib-chunk'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  filename",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'my-single-lib-chunk.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token function-variable function",parentName:"code"},"minChunks"),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"module",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},",")," count"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// If module has a path, and inside of the path exists the name "somelib",'),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// and it is used in 3 separate chunks/entries, then break it out into"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},'// a separate chunk with chunk keyname "my-single-lib-chunk", and filename "my-single-lib-chunk.js"'),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"resource ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"&&")," ",(0,t.kt)("span",{className:"token regex",parentName:"code"},"/somelib/"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"test"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),"module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"resource",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"&&")," count ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"===")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"3"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"As seen above, this example allows you to move only one lib to a separate file if and only if all conditions are met inside the function."),(0,t.kt)("p",null,"This concept may be used to obtain implicit common vendor chunks:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'vendor'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token function-variable function",parentName:"code"},"minChunks"),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"module"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token comment",parentName:"code"},"// this assumes your vendor imports exist in the node_modules directory"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"context ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"&&")," module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"context",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"includes"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'node_modules'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",{id:"manifest-file"},"Manifest file",(0,t.kt)("a",{href:"#manifest-file","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"To extract the webpack bootstrap logic into a separate file, use the ",(0,t.kt)("inlineCode",{parentName:"p"},"CommonsChunkPlugin")," on a ",(0,t.kt)("inlineCode",{parentName:"p"},"name")," which is not defined as ",(0,t.kt)("inlineCode",{parentName:"p"},"entry"),". Commonly the name ",(0,t.kt)("inlineCode",{parentName:"p"},"manifest")," is used. See the ",(0,t.kt)("a",{href:"/guides/caching",parentName:"p"},"caching guide")," for details."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'manifest'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  minChunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"Infinity"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",{id:"combining-implicit-common-vendor-chunks-and-manifest-file"},"Combining implicit common vendor chunks and manifest file",(0,t.kt)("a",{href:"#combining-implicit-common-vendor-chunks-and-manifest-file","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Since the ",(0,t.kt)("inlineCode",{parentName:"p"},"vendor")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"manifest")," chunk use a different definition for ",(0,t.kt)("inlineCode",{parentName:"p"},"minChunks"),", you need to invoke the plugin twice:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'vendor'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,t.kt)("span",{className:"token function-variable function",parentName:"code"},"minChunks"),(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token parameter",parentName:"code"},"module"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"context ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"&&")," module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"context",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,t.kt)("span",{className:"token function",parentName:"code"},"includes"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},"'node_modules'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,t.kt)("span",{className:"token class-name",parentName:"code"},"webpack",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"optimize",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"."),"CommonsChunkPlugin"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    name",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'manifest'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    minChunks",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"Infinity"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("h2",{id:"more-examples"},"More Examples",(0,t.kt)("a",{href:"#more-examples","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://github.com/webpack/webpack/tree/master/examples/common-chunk-and-vendor-chunk",parentName:"li"},"Common and Vendor Chunks")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://github.com/webpack/webpack/tree/8b888fedfaeaac6bd39168c0952cc19e6c34280a/examples/multiple-commons-chunks",parentName:"li"},"Multiple Common Chunks")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("a",{href:"https://github.com/webpack/webpack/tree/8b888fedfaeaac6bd39168c0952cc19e6c34280a/examples/multiple-entry-points-commons-chunk-css-bundle",parentName:"li"},"Multiple Entry Points with Commons Chunk"))))}o.isMDXComponent=!0,a.default=o}}]);