"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3575],{3575:function(e,a,n){n.r(a),n(7378);var t=n(2682);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function p({components:e,...a}){return(0,t.kt)("wrapper",s({components:e},a),(0,t.kt)("p",null,"If you have a more advanced project and use ",(0,t.kt)("a",{href:"https://www.vagrantup.com/",parentName:"p"},"Vagrant")," to run your development environment in a Virtual Machine, you'll often want to also run webpack in the VM."),(0,t.kt)("h2",{id:"configuring-the-project"},"Configuring the Project",(0,t.kt)("a",{href:"#configuring-the-project","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"To start, make sure that the ",(0,t.kt)("inlineCode",{parentName:"p"},"Vagrantfile")," has a static IP;"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-ruby",parentName:"pre"},(0,t.kt)("span",{className:"token constant",parentName:"code"},"Vagrant"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"configure",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,t.kt)("span",{className:"token string",parentName:"code"},'"2"'),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"do")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"|"),"config",(0,t.kt)("span",{className:"token operator",parentName:"code"},"|"),"\n  config",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"vm",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"network ",(0,t.kt)("span",{className:"token symbol",parentName:"code"},":private_network"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},",")," ip",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"10.10.10.61"'),"\n",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"end"))),(0,t.kt)("p",null,"Next, install ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-cli"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"@webpack-cli/serve"),", and ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-dev-server")," in your project;"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,t.kt)("span",{className:"token function",parentName:"code"},"npm")," ",(0,t.kt)("span",{className:"token function",parentName:"code"},"install")," --save-dev webpack webpack-cli @webpack-cli/serve webpack-dev-server")),(0,t.kt)("p",null,"Make sure to have a ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack.config.js")," file. If you haven't already, use this as a minimal example to get started:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-js",parentName:"pre"},"module",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  context",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," __dirname",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  entry",(0,t.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},"'./app.js'"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,t.kt)("p",null,"And create an ",(0,t.kt)("inlineCode",{parentName:"p"},"index.html")," file. The script tag should point to your bundle. If ",(0,t.kt)("inlineCode",{parentName:"p"},"output.filename")," is not specified in the config, this will be ",(0,t.kt)("inlineCode",{parentName:"p"},"bundle.js"),"."),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-html",parentName:"pre"},(0,t.kt)("span",{className:"token doctype",parentName:"code"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<!"),(0,t.kt)("span",{className:"token doctype-tag",parentName:"span"},"DOCTYPE")," ",(0,t.kt)("span",{className:"token name",parentName:"span"},"html"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"html"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n  ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"head"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n    ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"script")," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"src"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"/bundle.js",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'))," ",(0,t.kt)("span",{className:"token attr-name",parentName:"span"},"charset"),(0,t.kt)("span",{className:"token attr-value",parentName:"span"},(0,t.kt)("span",{className:"token punctuation attr-equals",parentName:"span"},"="),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"'),"utf-8",(0,t.kt)("span",{className:"token punctuation",parentName:"span"},'"')),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),(0,t.kt)("span",{className:"token script",parentName:"code"}),(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"script"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n  ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"head"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n  ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"body"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n    ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"<"),"h2"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"Heey!",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"h2"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n  ",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"body"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")),"\n",(0,t.kt)("span",{className:"token tag",parentName:"code"},(0,t.kt)("span",{className:"token tag",parentName:"span"},(0,t.kt)("span",{className:"token punctuation",parentName:"span"},"</"),"html"),(0,t.kt)("span",{className:"token punctuation",parentName:"span"},">")))),(0,t.kt)("p",null,"Note that you also need to create an ",(0,t.kt)("inlineCode",{parentName:"p"},"app.js")," file."),(0,t.kt)("h2",{id:"running-the-server"},"Running the Server",(0,t.kt)("a",{href:"#running-the-server","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"Now, let's run the server:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},"webpack serve --host ",(0,t.kt)("span",{className:"token number",parentName:"code"},"0.0"),".0.0 --client-web-socket-url ws://10.10.10.61:8080/ws --watch-options-poll")),(0,t.kt)("p",null,"By default, the server will only be accessible from localhost. We'll be accessing it from our host PC, so we need to change ",(0,t.kt)("inlineCode",{parentName:"p"},"--host")," to allow this."),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"webpack-dev-server")," will include a script in your bundle that connects to a WebSocket to reload when a change in any of your files occurs.\nThe ",(0,t.kt)("inlineCode",{parentName:"p"},"--client-web-socket-url")," flag makes sure the script knows where to look for the WebSocket. The server will use port ",(0,t.kt)("inlineCode",{parentName:"p"},"8080")," by default, so we should also specify that here."),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"--watch-options-poll")," makes sure that webpack can detect changes in your files. By default, webpack listens to events triggered by the filesystem, but VirtualBox has many problems with this."),(0,t.kt)("p",null,"The server should be accessible on ",(0,t.kt)("inlineCode",{parentName:"p"},"http://10.10.10.61:8080")," now. If you make a change in ",(0,t.kt)("inlineCode",{parentName:"p"},"app.js"),", it should live reload."),(0,t.kt)("h2",{id:"advanced-usage-with-nginx"},"Advanced Usage with nginx",(0,t.kt)("a",{href:"#advanced-usage-with-nginx","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"To mimic a more production-like environment, it is also possible to proxy the ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-dev-server")," with nginx."),(0,t.kt)("p",null,"In your nginx configuration file, add the following:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-nginx",parentName:"pre"},(0,t.kt)("span",{className:"token keyword",parentName:"code"},"server")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"location")," ",(0,t.kt)("span",{className:"token operator",parentName:"code"},"/")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"proxy_pass")," ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"http"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},":"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"/"),(0,t.kt)("span",{className:"token operator",parentName:"code"},"/"),(0,t.kt)("span",{className:"token number",parentName:"code"},"127.0"),(0,t.kt)("span",{className:"token number",parentName:"code"},".0"),(0,t.kt)("span",{className:"token number",parentName:"code"},".1"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},":"),(0,t.kt)("span",{className:"token number",parentName:"code"},"8080"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"proxy_http_version")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"1.1"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"proxy_set_header")," Upgrade ",(0,t.kt)("span",{className:"token variable",parentName:"code"},"$http_upgrade"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"proxy_set_header")," Connection ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"upgrade"'),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"error_page")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"502")," @start",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),"webpack",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),"dev",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),(0,t.kt)("span",{className:"token keyword",parentName:"code"},"server"),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n  ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"location")," @start",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),"webpack",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),"dev",(0,t.kt)("span",{className:"token operator",parentName:"code"},"-"),(0,t.kt)("span",{className:"token keyword",parentName:"code"},"server")," ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"default_type")," text",(0,t.kt)("span",{className:"token operator",parentName:"code"},"/"),"plain",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,t.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,t.kt)("span",{className:"token number",parentName:"code"},"502")," ",(0,t.kt)("span",{className:"token string",parentName:"code"},'"Please start the webpack-dev-server first."'),(0,t.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,t.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,t.kt)("p",null,"The ",(0,t.kt)("inlineCode",{parentName:"p"},"proxy_set_header")," lines are important, because they allow the WebSockets to work correctly."),(0,t.kt)("p",null,"The command to start ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-dev-server")," can then be changed to this:"),(0,t.kt)("pre",null,(0,t.kt)("code",{className:"hljs language-bash",parentName:"pre"},"webpack serve --client-web-socket-url ws://10.10.10.61:8080/ws --watch-options-poll")),(0,t.kt)("p",null,"This makes the server only accessible on ",(0,t.kt)("inlineCode",{parentName:"p"},"127.0.0.1"),", which is fine because nginx takes care of making it available on your host PC."),(0,t.kt)("h2",{id:"conclusion"},"Conclusion",(0,t.kt)("a",{href:"#conclusion","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,t.kt)("span",{className:"header-link",parentName:"a"}))),(0,t.kt)("p",null,"We made the Vagrant box accessible from a static IP, and then made ",(0,t.kt)("inlineCode",{parentName:"p"},"webpack-dev-server")," publicly accessible so it is reachable from a browser. We then tackled a common problem that VirtualBox doesn't send out filesystem events, causing the server to not reload on file changes."))}p.isMDXComponent=!0,a.default=p}}]);