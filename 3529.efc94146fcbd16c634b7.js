"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3529],{3529:function(e,a,t){t.r(a),t(7378);var n=t(2682);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function o({components:e,...a}){return(0,n.kt)("wrapper",s({components:e},a),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"es6 modules")),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"commonjs")),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"amd")),(0,n.kt)("h2",{id:"require-with-expression"},"require with expression",(0,n.kt)("a",{href:"#require-with-expression","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"A context is created if your request contains expressions, so the ",(0,n.kt)("strong",{parentName:"p"},"exact")," module is not known on compile time."),(0,n.kt)("p",null,"Example, given we have the following folder structure including ",(0,n.kt)("inlineCode",{parentName:"p"},".ejs")," files:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-bash",parentName:"pre"},"example_directory\n│\n└───template\n│   │   table.ejs\n│   │   table-row.ejs\n│   │\n│   └───directory\n│       │   another.ejs")),(0,n.kt)("p",null,"When following ",(0,n.kt)("inlineCode",{parentName:"p"},"require()")," call is evaluated:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,n.kt)("span",{className:"token function",parentName:"code"},"require"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'./template/'")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"+")," name ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'.ejs'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"Webpack parses the ",(0,n.kt)("inlineCode",{parentName:"p"},"require()")," call and extracts some information:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-code",parentName:"pre"},"Directory: ./template\nRegular expression: /^.*\\.ejs$/\n")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"context module")),(0,n.kt)("p",null,"A context module is generated. It contains references to ",(0,n.kt)("strong",{parentName:"p"},"all modules in that directory")," that can be required with a request matching the regular expression. The context module contains a map which translates requests to module ids."),(0,n.kt)("p",null,"Example map:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"./table.ejs"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token number",parentName:"code"},"42"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"./table-row.ejs"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token number",parentName:"code"},"43"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"./directory/another.ejs"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token number",parentName:"code"},"44"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("p",null,"The context module also contains some runtime logic to access the map."),(0,n.kt)("p",null,"This means dynamic requires are supported but will cause all matching modules to be included in the bundle."),(0,n.kt)("h2",{id:"requirecontext"},"require.context",(0,n.kt)("a",{href:"#requirecontext","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"You can create your own context with the ",(0,n.kt)("inlineCode",{parentName:"p"},"require.context()")," function."),(0,n.kt)("p",null,"It allows you to pass in a directory to search, a flag indicating whether subdirectories should be searched\ntoo, and a regular expression to match files against."),(0,n.kt)("p",null,"Webpack parses for ",(0,n.kt)("inlineCode",{parentName:"p"},"require.context()")," in the code while building."),(0,n.kt)("p",null,"The syntax is as follows:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"require",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"context"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"\n  directory",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"useSubdirectories ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"regExp ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/^\\.\\/.*$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"mode ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'sync'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"Examples:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"require",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"context"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'./test'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token boolean",parentName:"code"},"false"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.test\\.js$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token comment",parentName:"code"},"// a context with files from the test directory that can be required with a request ending with `.test.js`."))),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},"require",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"context"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'../'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.stories\\.js$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token comment",parentName:"code"},"// a context with all files in the parent folder and descending folders ending with `.stories.js`."))),(0,n.kt)("aside",{className:"warning"},(0,n.kt)("h6",{className:"warning__prefix",parentName:"aside"},"warning"),(0,n.kt)("p",{parentName:"aside"},"The arguments passed to ",(0,n.kt)("inlineCode",{parentName:"p"},"require.context")," must be literals!")),(0,n.kt)("h3",{id:"context-module-api"},"context module API",(0,n.kt)("a",{href:"#context-module-api","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"A context module exports a (require) function that takes one argument: the request."),(0,n.kt)("p",null,"The exported function has 3 properties: ",(0,n.kt)("inlineCode",{parentName:"p"},"resolve"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"keys"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"id"),"."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"resolve")," is a function and returns the module id of the parsed request."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"keys")," is a function that returns an array of all possible requests that the context module can handle.")),(0,n.kt)("p",null,"This can be useful if you want to require all files in a directory or matching a pattern, Example:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"importAll"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"r"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  r",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"keys"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"forEach"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"r",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n",(0,n.kt)("span",{className:"token function",parentName:"code"},"importAll"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"require",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"context"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'../components/'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.js$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-javascript",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," cache ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"importAll"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"r"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  r",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"keys"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"forEach"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"key"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"cache",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"key",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"r"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"key",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n\n",(0,n.kt)("span",{className:"token function",parentName:"code"},"importAll"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"require",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"context"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'../components/'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token boolean",parentName:"code"},"true"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.js$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token comment",parentName:"code"},"// At build-time cache will be populated with all required modules."))),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"id")," is the module id of the context module. This may be useful for ",(0,n.kt)("inlineCode",{parentName:"li"},"module.hot.accept"),".")))}o.isMDXComponent=!0,a.default=o}}]);