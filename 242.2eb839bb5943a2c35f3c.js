"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[242],{242:function(e,a,t){t.r(a),t(7378);var n=t(2682);function s(){return(s=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function o({components:e,...a}){return(0,n.kt)("wrapper",s({components:e},a),(0,n.kt)("p",null,"A loader is a node module that exports a function. This function is called when a resource should be transformed by this loader. The given function will have access to the ",(0,n.kt)("a",{href:"/api/loaders/",parentName:"p"},"Loader API")," using the ",(0,n.kt)("inlineCode",{parentName:"p"},"this")," context provided to it."),(0,n.kt)("h2",{id:"setup"},"Setup",(0,n.kt)("a",{href:"#setup","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Before we dig into the different types of loaders, their usage, and examples, let's take a look at the three ways you can develop and test a loader locally."),(0,n.kt)("p",null,"To test a single loader, you can use ",(0,n.kt)("inlineCode",{parentName:"p"},"path")," to ",(0,n.kt)("inlineCode",{parentName:"p"},"resolve")," a local file within a rule object:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," path ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"require"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nmodule",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n  module",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    rules",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        test",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.js$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        use",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n          ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n            loader",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'path/to/loader.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n            options",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n              ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"/* ... */"),"\n            ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n          ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"To test multiple, you can utilize the ",(0,n.kt)("inlineCode",{parentName:"p"},"resolveLoader.modules")," configuration to update where webpack will search for loaders. For example, if you had a local ",(0,n.kt)("inlineCode",{parentName:"p"},"/loaders")," directory in your project:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," path ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"require"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nmodule",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n  resolveLoader",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    modules",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,n.kt)("span",{className:"token string",parentName:"code"},"'node_modules'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'loaders'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"By the way, if you've already created a separate repository and package for your loader, you could ",(0,n.kt)("a",{href:"https://docs.npmjs.com/cli/link",parentName:"p"},(0,n.kt)("inlineCode",{parentName:"a"},"npm link"))," it to the project in which you'd like to test it out."),(0,n.kt)("aside",{className:"tip"},(0,n.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,n.kt)("p",{parentName:"aside"},"You can use ",(0,n.kt)("a",{href:"https://github.com/webpack-contrib/webpack-defaults",parentName:"p"},(0,n.kt)("inlineCode",{parentName:"a"},"webpack-defaults")," package")," to generate boilerplate code necessary to start writing your loader.")),(0,n.kt)("h2",{id:"simple-usage"},"Simple Usage",(0,n.kt)("a",{href:"#simple-usage","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"When a single loader is applied to the resource, the loader is called with only one parameter – a string containing the content of the resource file."),(0,n.kt)("p",null,"Synchronous loaders can ",(0,n.kt)("inlineCode",{parentName:"p"},"return")," a single value representing the transformed module. In more complex cases, the loader can return any number of values by using the ",(0,n.kt)("inlineCode",{parentName:"p"},"this.callback(err, values...)")," function. Errors are either passed to the ",(0,n.kt)("inlineCode",{parentName:"p"},"this.callback")," function or thrown in a sync loader."),(0,n.kt)("p",null,"The loader is expected to give back one or two values. The first value is a resulting JavaScript code as string or buffer. The second optional value is a SourceMap as JavaScript object."),(0,n.kt)("h2",{id:"complex-usage"},"Complex Usage",(0,n.kt)("a",{href:"#complex-usage","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"When multiple loaders are chained, it is important to remember that they are executed in reverse order – either right to left or bottom to top depending on array format."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The last loader, called first, will be passed the contents of the raw resource."),(0,n.kt)("li",{parentName:"ul"},"The first loader, called last, is expected to return JavaScript and an optional source map."),(0,n.kt)("li",{parentName:"ul"},"The loaders in between will be executed with the result(s) of the previous loader in the chain.")),(0,n.kt)("p",null,"In the following example, the ",(0,n.kt)("inlineCode",{parentName:"p"},"foo-loader")," would be passed the raw resource and the ",(0,n.kt)("inlineCode",{parentName:"p"},"bar-loader")," would receive the output of the ",(0,n.kt)("inlineCode",{parentName:"p"},"foo-loader")," and return the final transformed module and a source map if necessary."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"webpack.config.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},"module",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"//..."),"\n  module",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    rules",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        test",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.js/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        use",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,n.kt)("span",{className:"token string",parentName:"code"},"'bar-loader'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'foo-loader'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("h2",{id:"guidelines"},"Guidelines",(0,n.kt)("a",{href:"#guidelines","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"The following guidelines should be followed when writing a loader. They are ordered in terms of importance and some only apply in certain scenarios, read the detailed sections that follow for more information."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Keep them ",(0,n.kt)("strong",{parentName:"li"},"simple"),"."),(0,n.kt)("li",{parentName:"ul"},"Utilize ",(0,n.kt)("strong",{parentName:"li"},"chaining"),"."),(0,n.kt)("li",{parentName:"ul"},"Emit ",(0,n.kt)("strong",{parentName:"li"},"modular")," output."),(0,n.kt)("li",{parentName:"ul"},"Make sure they're ",(0,n.kt)("strong",{parentName:"li"},"stateless"),"."),(0,n.kt)("li",{parentName:"ul"},"Employ ",(0,n.kt)("strong",{parentName:"li"},"loader utilities"),"."),(0,n.kt)("li",{parentName:"ul"},"Mark ",(0,n.kt)("strong",{parentName:"li"},"loader dependencies"),"."),(0,n.kt)("li",{parentName:"ul"},"Resolve ",(0,n.kt)("strong",{parentName:"li"},"module dependencies"),"."),(0,n.kt)("li",{parentName:"ul"},"Extract ",(0,n.kt)("strong",{parentName:"li"},"common code"),"."),(0,n.kt)("li",{parentName:"ul"},"Avoid ",(0,n.kt)("strong",{parentName:"li"},"absolute paths"),"."),(0,n.kt)("li",{parentName:"ul"},"Use ",(0,n.kt)("strong",{parentName:"li"},"peer dependencies"),".")),(0,n.kt)("h3",{id:"simple"},"Simple",(0,n.kt)("a",{href:"#simple","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Loaders should do only a single task. This not only makes the job of maintaining each loader easier, but also allows them to be chained for usage in more scenarios."),(0,n.kt)("h3",{id:"chaining"},"Chaining",(0,n.kt)("a",{href:"#chaining","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Take advantage of the fact that loaders can be chained together. Instead of writing a single loader that tackles five tasks, write five simpler loaders that divide this effort. Isolating them not only keeps each individual loader simple, but may allow for them to be used for something you hadn't thought of originally."),(0,n.kt)("p",null,"Take the case of rendering a template file with data specified via loader options or query parameters. It could be written as a single loader that compiles the template from source, executes it and returns a module that exports a string containing the HTML code. However, in accordance with guidelines, an ",(0,n.kt)("inlineCode",{parentName:"p"},"apply-loader")," exists that can be chained with other open source loaders:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"pug-loader"),": Convert template to a module that exports a function."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"apply-loader"),": Executes the function with loader options and returns raw HTML."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"html-loader"),": Accepts HTML and outputs a valid JavaScript module.")),(0,n.kt)("aside",{className:"tip"},(0,n.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,n.kt)("p",{parentName:"aside"},"The fact that loaders can be chained also means they don't necessarily have to output JavaScript. As long as the next loader in the chain can handle its output, the loader can return any type of module.")),(0,n.kt)("h3",{id:"modular"},"Modular",(0,n.kt)("a",{href:"#modular","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Keep the output modular. Loader generated modules should respect the same design principles as normal modules."),(0,n.kt)("h3",{id:"stateless"},"Stateless",(0,n.kt)("a",{href:"#stateless","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Make sure the loader does not retain state between module transformations. Each run should always be independent of other compiled modules as well as previous compilations of the same module."),(0,n.kt)("h3",{id:"loader-utilities"},"Loader Utilities",(0,n.kt)("a",{href:"#loader-utilities","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Take advantage of the ",(0,n.kt)("a",{href:"https://github.com/webpack/loader-utils",parentName:"p"},(0,n.kt)("inlineCode",{parentName:"a"},"loader-utils"))," package. It provides a variety of useful tools but one of the most common is retrieving the options passed to the loader. Along with ",(0,n.kt)("inlineCode",{parentName:"p"},"loader-utils"),", the ",(0,n.kt)("a",{href:"https://github.com/webpack-contrib/schema-utils",parentName:"p"},(0,n.kt)("inlineCode",{parentName:"a"},"schema-utils"))," package should be used for consistent JSON Schema based validation of loader options. Here's a brief example that utilizes both:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"loader.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," getOptions ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'loader-utils'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," validate ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'schema-utils'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," schema ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  type",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'object'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  properties",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    test",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      type",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'string'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"default")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"source"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," options ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"getOptions"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token keyword",parentName:"code"},"this"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token function",parentName:"code"},"validate"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"schema",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," options",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    name",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'Example Loader'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    baseDataPath",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'options'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"// Apply some transformations to the source..."),"\n\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,n.kt)("span",{className:"token template-string",parentName:"code"},(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`"),(0,n.kt)("span",{className:"token string",parentName:"span"},"export default "),(0,n.kt)("span",{className:"token interpolation",parentName:"span"},(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"${"),(0,n.kt)("span",{className:"token constant",parentName:"span"},"JSON"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"."),(0,n.kt)("span",{className:"token function",parentName:"span"},"stringify"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"("),"source",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"}")),(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`")),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("h3",{id:"loader-dependencies"},"Loader Dependencies",(0,n.kt)("a",{href:"#loader-dependencies","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"If a loader uses external resources (i.e. by reading from filesystem), they ",(0,n.kt)("strong",{parentName:"p"},"must")," indicate it. This information is used to invalidate cacheable loaders and recompile in watch mode. Here's a brief example of how to accomplish this using the ",(0,n.kt)("inlineCode",{parentName:"p"},"addDependency")," method:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"loader.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," path ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"default")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"source"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"var")," callback ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"this"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"async"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"var")," headerPath ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'header.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"this"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"addDependency"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"headerPath",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  fs",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"readFile"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"headerPath",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'utf-8'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},",")," header"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"callback"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,n.kt)("span",{className:"token function",parentName:"code"},"callback"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token keyword",parentName:"code"},"null"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," header ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"+")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'\\n'")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"+")," source",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("h3",{id:"module-dependencies"},"Module Dependencies",(0,n.kt)("a",{href:"#module-dependencies","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Depending on the type of module, there may be a different schema used to specify dependencies. In CSS for example, the ",(0,n.kt)("inlineCode",{parentName:"p"},"@import")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"url(...)")," statements are used. These dependencies should be resolved by the module system."),(0,n.kt)("p",null,"This can be done in one of two ways:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"By transforming them to ",(0,n.kt)("inlineCode",{parentName:"li"},"require")," statements."),(0,n.kt)("li",{parentName:"ul"},"Using the ",(0,n.kt)("inlineCode",{parentName:"li"},"this.resolve")," function to resolve the path.")),(0,n.kt)("p",null,"The ",(0,n.kt)("inlineCode",{parentName:"p"},"css-loader")," is a good example of the first approach. It transforms dependencies to ",(0,n.kt)("inlineCode",{parentName:"p"},"require"),"s, by replacing ",(0,n.kt)("inlineCode",{parentName:"p"},"@import")," statements with a ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," to the other stylesheet and ",(0,n.kt)("inlineCode",{parentName:"p"},"url(...)")," with a ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," to the referenced file."),(0,n.kt)("p",null,"In the case of the ",(0,n.kt)("inlineCode",{parentName:"p"},"less-loader"),", it cannot transform each ",(0,n.kt)("inlineCode",{parentName:"p"},"@import")," to a ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," because all ",(0,n.kt)("inlineCode",{parentName:"p"},".less")," files must be compiled in one pass for variables and mixin tracking. Therefore, the ",(0,n.kt)("inlineCode",{parentName:"p"},"less-loader")," extends the less compiler with custom path resolving logic. It then takes advantage of the second approach, ",(0,n.kt)("inlineCode",{parentName:"p"},"this.resolve"),", to resolve the dependency through webpack."),(0,n.kt)("aside",{className:"tip"},(0,n.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,n.kt)("p",{parentName:"aside"},"If the language only accepts relative urls (e.g. ",(0,n.kt)("inlineCode",{parentName:"p"},"url(file)")," always refers to ",(0,n.kt)("inlineCode",{parentName:"p"},"./file"),"), you can use the ",(0,n.kt)("inlineCode",{parentName:"p"},"~")," convention to specify references to installed modules (e.g. those in ",(0,n.kt)("inlineCode",{parentName:"p"},"node_modules"),"). In the case of ",(0,n.kt)("inlineCode",{parentName:"p"},"url"),", that would look something like ",(0,n.kt)("inlineCode",{parentName:"p"},"url('~some-library/image.jpg')"),".")),(0,n.kt)("h3",{id:"common-code"},"Common Code",(0,n.kt)("a",{href:"#common-code","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Avoid generating common code in every module the loader processes. Instead, create a runtime file in the loader and generate a ",(0,n.kt)("inlineCode",{parentName:"p"},"require")," to that shared module:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"src/loader-runtime.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," someOtherModule ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"require"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'./some-other-module'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\nmodule",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function-variable function",parentName:"code"},"exports")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"runtime"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"params"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," x ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," params",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"y ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"*")," ",(0,n.kt)("span",{className:"token number",parentName:"code"},"2"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"someOtherModule"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"params",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," x",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"src/loader.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," runtime ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'./loader-runtime.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"default")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"loader"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"source"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token comment",parentName:"code"},"// Custom loader logic"),"\n\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,n.kt)("span",{className:"token template-string",parentName:"code"},(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`"),(0,n.kt)("span",{className:"token interpolation",parentName:"span"},(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"${"),(0,n.kt)("span",{className:"token function",parentName:"span"},"runtime"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"{"),"\n    source",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},","),"\n    y",(0,n.kt)("span",{className:"token operator",parentName:"span"},":")," Math",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"."),(0,n.kt)("span",{className:"token function",parentName:"span"},"random"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"}")),(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`")),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("h3",{id:"absolute-paths"},"Absolute Paths",(0,n.kt)("a",{href:"#absolute-paths","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"Don't insert absolute paths into the module code as they break hashing when the root for the project is moved. There's a ",(0,n.kt)("a",{href:"https://github.com/webpack/loader-utils#stringifyrequest",parentName:"p"},(0,n.kt)("inlineCode",{parentName:"a"},"stringifyRequest"))," method in ",(0,n.kt)("inlineCode",{parentName:"p"},"loader-utils")," which can be used to convert an absolute path to a relative one."),(0,n.kt)("h3",{id:"peer-dependencies"},"Peer Dependencies",(0,n.kt)("a",{href:"#peer-dependencies","aria-hidden":"true",tabIndex:"-1",parentName:"h3"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"If the loader you're working on is a simple wrapper around another package, then you should include the package as a ",(0,n.kt)("inlineCode",{parentName:"p"},"peerDependency"),". This approach allows the application's developer to specify the exact version in the ",(0,n.kt)("inlineCode",{parentName:"p"},"package.json")," if desired."),(0,n.kt)("p",null,"For instance, the ",(0,n.kt)("inlineCode",{parentName:"p"},"sass-loader")," ",(0,n.kt)("a",{href:"https://github.com/webpack-contrib/sass-loader/blob/master/package.json",parentName:"p"},"specifies ",(0,n.kt)("inlineCode",{parentName:"a"},"node-sass"))," as peer dependency like so:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"peerDependencies"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"node-sass"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},'"^4.0.0"'),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("h2",{id:"testing"},"Testing",(0,n.kt)("a",{href:"#testing","aria-hidden":"true",tabIndex:"-1",parentName:"h2"},(0,n.kt)("span",{className:"header-link",parentName:"a"}))),(0,n.kt)("p",null,"So you've written a loader, followed the guidelines above, and have it set up to run locally. What's next? Let's go through a unit testing example to ensure our loader is working the way we expect. We'll be using the ",(0,n.kt)("a",{href:"https://jestjs.io/",parentName:"p"},"Jest")," framework to do this. We'll also install ",(0,n.kt)("inlineCode",{parentName:"p"},"babel-jest")," and some presets that will allow us to use the ",(0,n.kt)("inlineCode",{parentName:"p"},"import")," / ",(0,n.kt)("inlineCode",{parentName:"p"},"export")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"async")," / ",(0,n.kt)("inlineCode",{parentName:"p"},"await"),". Let's start by installing and saving these as a ",(0,n.kt)("inlineCode",{parentName:"p"},"devDependencies"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,n.kt)("span",{className:"token function",parentName:"code"},"npm")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"install")," --save-dev jest babel-jest @babel/core @babel/preset-env")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"babel.config.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},"module",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"exports ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  presets",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n      ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'@babel/preset-env'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n        targets",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n          node",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'current'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,"Our loader will process ",(0,n.kt)("inlineCode",{parentName:"p"},".txt")," files and replace any instance of ",(0,n.kt)("inlineCode",{parentName:"p"},"[name]")," with the ",(0,n.kt)("inlineCode",{parentName:"p"},"name")," option given to the loader. Then it will output a valid JavaScript module containing the text as its default export:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"src/loader.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," getOptions ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'loader-utils'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"default")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"function")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"loader"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"source"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," options ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"getOptions"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token keyword",parentName:"code"},"this"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  source ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," source",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"replace"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\[name\\]/g"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," options",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"name",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,n.kt)("span",{className:"token template-string",parentName:"code"},(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`"),(0,n.kt)("span",{className:"token string",parentName:"span"},"export default "),(0,n.kt)("span",{className:"token interpolation",parentName:"span"},(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"${"),(0,n.kt)("span",{className:"token constant",parentName:"span"},"JSON"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"."),(0,n.kt)("span",{className:"token function",parentName:"span"},"stringify"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"("),"source",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},")"),(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"}")),(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`")),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("p",null,"We'll use this loader to process the following file:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"test/example.txt")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-bash",parentName:"pre"},"Hey ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"name",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token operator",parentName:"code"},"!"))),(0,n.kt)("p",null,"Pay close attention to this next step as we'll be using the ",(0,n.kt)("a",{href:"/api/node",parentName:"p"},"Node.js API")," and ",(0,n.kt)("a",{href:"https://github.com/streamich/memfs",parentName:"p"},(0,n.kt)("inlineCode",{parentName:"a"},"memfs"))," to execute webpack. This lets us avoid emitting ",(0,n.kt)("inlineCode",{parentName:"p"},"output")," to disk and will give us access to the ",(0,n.kt)("inlineCode",{parentName:"p"},"stats")," data which we can use to grab our transformed module:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-bash",parentName:"pre"},(0,n.kt)("span",{className:"token function",parentName:"code"},"npm")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"install")," --save-dev webpack memfs")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"test/compiler.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," path ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'path'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," webpack ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'webpack'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," createFsFromVolume",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," Volume ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'memfs'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"export")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"default")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"fixture",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},",")," options ",(0,n.kt)("span",{className:"token operator",parentName:"span"},"=")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"{"),(0,n.kt)("span",{className:"token punctuation",parentName:"span"},"}")),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," compiler ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"webpack"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    context",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," __dirname",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    entry",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token template-string",parentName:"code"},(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`"),(0,n.kt)("span",{className:"token string",parentName:"span"},"./"),(0,n.kt)("span",{className:"token interpolation",parentName:"span"},(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"${"),"fixture",(0,n.kt)("span",{className:"token interpolation-punctuation punctuation",parentName:"span"},"}")),(0,n.kt)("span",{className:"token template-punctuation string",parentName:"span"},"`")),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    output",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      path",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      filename",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'bundle.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    module",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      rules",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),"\n        ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n          test",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token regex",parentName:"code"},"/\\.txt$/"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n          use",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n            loader",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"__dirname",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'../src/loader.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n            options",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n          ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n        ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n      ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  compiler",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"outputFileSystem ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"createFsFromVolume"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,n.kt)("span",{className:"token class-name",parentName:"code"},"Volume"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  compiler",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"outputFileSystem",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"join ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"join"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"bind"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"path",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"return")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"new")," ",(0,n.kt)("span",{className:"token class-name",parentName:"code"},"Promise"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"resolve",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},",")," reject"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    compiler",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"run"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token parameter",parentName:"code"},"err",(0,n.kt)("span",{className:"token punctuation",parentName:"span"},",")," stats"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n      ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"reject"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"err",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n      ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"if")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"hasErrors"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"reject"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"toJson"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"errors",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n      ",(0,n.kt)("span",{className:"token function",parentName:"code"},"resolve"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"stats",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n    ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("aside",{className:"tip"},(0,n.kt)("h6",{className:"tip__prefix",parentName:"aside"},"tip"),(0,n.kt)("p",{parentName:"aside"},"In this case, we've inlined our webpack configuration but you can also accept a configuration as a parameter to the exported function. This would allow you to test multiple setups using the same compiler module.")),(0,n.kt)("p",null,"And now, finally, we can write our test and add an npm script to run it:"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"test/loader.test.js")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-js",parentName:"pre"},(0,n.kt)("span",{className:"token comment",parentName:"code"},"/**\n * @jest-environment node\n */"),"\n",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"import")," compiler ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"from")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'./compiler.js'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n",(0,n.kt)("span",{className:"token function",parentName:"code"},"test"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'Inserts name and outputs JavaScript'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"async")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")")," ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=>")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," stats ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"await")," ",(0,n.kt)("span",{className:"token function",parentName:"code"},"compiler"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'example.txt'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},",")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," name",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},"'Alice'")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n  ",(0,n.kt)("span",{className:"token keyword",parentName:"code"},"const")," output ",(0,n.kt)("span",{className:"token operator",parentName:"code"},"=")," stats",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"toJson"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{")," source",(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token boolean",parentName:"code"},"true")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"modules",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"["),(0,n.kt)("span",{className:"token number",parentName:"code"},"0"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"]"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),"source",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n\n  ",(0,n.kt)("span",{className:"token function",parentName:"code"},"expect"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"output",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"."),(0,n.kt)("span",{className:"token function",parentName:"code"},"toBe"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),(0,n.kt)("span",{className:"token string",parentName:"code"},"'export default \"Hey Alice!\\\\n\"'"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},";"))),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"package.json")),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-json",parentName:"pre"},(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n  ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"scripts"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"test"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},'"jest"'),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),(0,n.kt)("span",{className:"token punctuation",parentName:"code"},","),"\n  ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"jest"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"{"),"\n    ",(0,n.kt)("span",{className:"token property",parentName:"code"},'"testEnvironment"'),(0,n.kt)("span",{className:"token operator",parentName:"code"},":")," ",(0,n.kt)("span",{className:"token string",parentName:"code"},'"node"'),"\n  ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"),"\n",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"}"))),(0,n.kt)("p",null,"With everything in place, we can run it and see if our new loader passes the test:"),(0,n.kt)("pre",null,(0,n.kt)("code",{className:"hljs language-bash",parentName:"pre"}," PASS  test/loader.test.js\n  ✓ Inserts name and outputs JavaScript ",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},"("),"229ms",(0,n.kt)("span",{className:"token punctuation",parentName:"code"},")"),"\n\nTest Suites: ",(0,n.kt)("span",{className:"token number",parentName:"code"},"1")," passed, ",(0,n.kt)("span",{className:"token number",parentName:"code"},"1")," total\nTests:       ",(0,n.kt)("span",{className:"token number",parentName:"code"},"1")," passed, ",(0,n.kt)("span",{className:"token number",parentName:"code"},"1")," total\nSnapshots:   ",(0,n.kt)("span",{className:"token number",parentName:"code"},"0")," total\nTime:        ",(0,n.kt)("span",{className:"token number",parentName:"code"},"1"),".853s, estimated 2s\nRan all ",(0,n.kt)("span",{className:"token builtin class-name",parentName:"code"},"test")," suites.")),(0,n.kt)("p",null,"It worked! At this point you should be ready to start developing, testing, and deploying your own loaders. We hope that you'll share your creations with the rest of the community!"))}o.isMDXComponent=!0,a.default=o}}]);